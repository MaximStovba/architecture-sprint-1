# Разделение проекта на микрофронтенды

## Уровень 1. Проектирование

Для разделения проекта на микрофронтенды было рассмотрено два популярных подхода:

1. **Webpack Module Federation**
2. **Single SPA**

### Webpack Module Federation

#### Преимущества:

- **Простота интеграции:** подходит для работы с проектами на React без значительного рефакторинга.
- **Динамическая загрузка модулей:** снижение объема начальной загрузки за счет подгрузки только необходимых модулей.
- **Локальная разработка:** упрощает работу отдельных команд, так как модули разрабатываются и деплоятся независимо.
- **Совместимость:** Webpack широко используется в React-проектах.

#### Ограничения:

- Ограничен работой с одним фреймворком.

### Single SPA

#### Преимущества:

- **Поддержка нескольких фреймворков:** можно объединить приложения на React, Angular, Vue и других технологиях.
- **Улучшает время первоначальной загрузки:** поддерживает ленивую загрузку, что позволяет загружать только необходимые фрагменты кода по требованию. Это улучшает время первоначальной загрузки и оптимизирует использование ресурсов.
- **Позволяет развёртывать микрофронтенды независимо:** фреймворк позволяет командам разрабатывать и развёртывать свои части приложения отдельно.

#### Ограничения:

- Более сложная настройка по сравнению с Webpack Module Federation.

### Описание решения

Для текущего проекта, который полностью написан на React, **Webpack Module Federation** является оптимальным выбором благодаря следующим причинам:

- Простота внедрения в существующий проект.
- Быстрая настройка и минимальные изменения в текущей архитектуре.
- Возможность динамической загрузки модулей для улучшения производительности.

Выбор **Webpack Module Federation** обеспечит простоту и скорость разделения React-проекта на микрофронтенды. Это решение позволит в перспективе командам работать над модулями независимо, обеспечивая при этом высокую производительность и легкость интеграции.

Если в будущем потребуется интеграция модулей на других (различных) фреймворках, можно будет рассмотреть переход на **Single SPA**.

## Уровень 2. Планирование изменений

## Структура микрофронтендов

Все микрофронтенды находятся в папке `frontend/microfrontend`.

Для обеспечения работоспособности:

- Установил `react-router-dom` для маршрутизации с помощью `BrowserRouter`.
- Настроил загрузку SVG, добавив `file-loader` и отредактировав Webpack config.

Проект разделен на следующие микрофронтенды:

### 1. **Host** (порт: 8080)

- Компоненты:
  - `App`
  - `Main`
  - `ProtectedRoute`
- Контекст `CurrentUserContext`

**Обоснование:**
Host выступает как основное приложение, связывающее остальные микрофронтенды. Оно управляет маршрутизацией, контекстами и общими API-запросами.

### 2. **Footer** (порт: 8081)

- Компоненты:
  - `Footer`

**Обоснование:**
Footer выделен в отдельный микрофронтенд для упрощения разработки и повторного использования. Он не зависит от других частей приложения и может быть легко изменен или заменен.

### 3. **Header** (порт: 8082)

- Компоненты:
  - `Header`
- Навигация (`Route`, `Link`)
- Логотип

**Обоснование:**
Header содержит навигацию и авторизационные элементы, которые могут часто изменяться. Выделение в отдельный сервис позволяет независимо обновлять шапку без затрагивания других частей приложения.

### 4. **Auth** (порт: 8083)

- Компоненты:
  - `Register`
  - `Login`
  - `InfoTooltip`

**Обоснование:**
Функциональность авторизации и регистрации пользователей имеет независимую логику и может быть повторно использована в других проектах. Выделение в отдельный сервис упрощает поддержку.

### 5. **Avatar** (порт: 8084)

- Компоненты:
  - `Avatar`
  - `EditAvatarPopup`
  - `PopupWithForm`
- API взаимодействие (`api.setUserAvatar`)

**Обоснование:**
Управление аватаром пользователя выделено в отдельный сервис, чтобы упростить обработку изменений аватара и изолировать эту функциональность от других частей профиля.

### 6. **Profile** (порт: 8085)

- Компоненты:
  - `Profile`
  - `EditProfilePopup`
  - `PopupWithForm`
- API взаимодействие (`api.setUserInfo`)

**Обоснование:**
Профиль пользователя включает определенную логику редактирования и отображения данных. Выделение в отдельный сервис позволяет изолировать эту логику и ускорить разработку.

### 7. **Images** (порт: 8086)

- Компоненты:
  - `Card`
  - `Cards`
  - `AddButton`
  - `ImagePopup`
  - `AddPlacePopup`
  - `PopupWithForm`
- API взаимодействие (`api.addCard`, `api.changeLikeCardStatus`, `api.removeCard`)

**Обоснование:**
Управление галереей изображений включает функционал добавления, удаления, лайков и просмотра. Это сложная область, которая требует независимого тестирования и доработки, в связи с чем выделена в отдельный микрофронтенд.

## Уровень 3. Запуск готового кода

# Запуск проекта

Проект выполнен на 3-ем уровне сложности. Для проверки микрофронтенды необходимо запускать в порядке их зависимости. В данном случае `Host` зависит от всех остальных микрофронтендов, поэтому порядок запуска будет следующим:

1. `Footer` (порт 8081)
2. `Header` (порт 8082)
3. `Auth` (порт 8083)
4. `Avatar` (порт 8084)
5. `Profile` (порт 8085)
6. `Images` (порт 8086)
7. `Host` (порт 8080)

### Инструкция по запуску

Для каждого микрофронтенда выполните следующие шаги:

1. **Перейдите в директорию микрофронтенда**:

   ```bash
   cd frontend/microfrontend/<имя_микрофронтенда>
   ```

2. **Установите зависимости**:

   ```bash
   npm install
   ```

3. **Запустите микрофронтенд**:

   ```bash
   npm start
   ```

4. **Повторите шаги для всех микрофронтендов в порядке их зависимости**.

### Запуск всего проекта

После запуска всех микрофронтендов, запустите `Host`:

1. Перейдите в директорию `Host`:

   ```bash
   cd frontend/microfrontend/host
   ```

2. Установите зависимости:

   ```bash
   npm install
   ```

3. Запустите `Host`:
   ```bash
   npm start
   ```
